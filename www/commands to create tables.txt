CREATE DATABASE final;
USE final;
CREATE TABLE Users(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,    
firstname VARCHAR(255) NOT NULL,
lastname VARCHAR(255) NOT NULL,   
email VARCHAR(255) NOT NULL,
phone VARCHAR (15) NOT NULL,
dob DATE NOT NULL,
gender CHAR(1) NOT NULL,      
city VARCHAR(255) NOT NULL,
username VARCHAR(255) NOT NULL,
password VARCHAR(255) NOT NULL,
education VARCHAR(255),
job VARCHAR(255),
movie VARCHAR(255),
book VARCHAR(255),
profile_pic VARCHAR(255));

CREATE TABLE Visitors(
id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
host_id INT NOT NULL,
guest_id INT NOT NULL,
visitied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
FOREIGN KEY (host_id) REFERENCES Users(id),
FOREIGN KEY (guest_id) REFERENCES Users(id));

CREATE TABLE Friends(
	friend1_id INT NOT NULL,
friend2_id INT NOT NULL,
FOREIGN KEY (friend1_id) REFERENCES Users(id),
FOREIGN KEY (friend2_id) REFERENCES Users(id));


CREATE TABLE Friend_requests(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	request_author_id INT NOT NULL,
requested_who_id INT NOT NULL,
FOREIGN KEY (request_author_id) REFERENCES Users(id),
FOREIGN KEY (requested_who_id) REFERENCES Users(id));

CREATE TABLE Chats(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	speaker1_id INT NOT NULL,
speaker2_id INT NOT NULL,
FOREIGN KEY (speaker1_id) REFERENCES Users(id),
FOREIGN KEY (speaker2_id) REFERENCES Users(id));

CREATE TABLE Messages(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
chat_id INT NOT NULL,
	sender_id INT NOT NULL,
receiver_id INT NOT NULL,
message VARCHAR(255),
sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
FOREIGN KEY (sender_id) REFERENCES Users(id),
FOREIGN KEY (receiver_id) REFERENCES Users(id),
FOREIGN KEY (chat_id) REFERENCES Chats(id));


CREATE TABLE Posts(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
author_id INT NOT NULL,
text VARCHAR(255),
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
FOREIGN KEY (author_id) REFERENCES Users(id));

CREATE TABLE Attachments(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
post_id INT NOT NULL,
file VARCHAR(255),
FOREIGN KEY (post_id) REFERENCES Posts(id));

CREATE TABLE Likes(                
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
post_id INT NOT NULL,
who_liked_id INT NOT NULL,
FOREIGN KEY (post_id) REFERENCES Posts(id),
FOREIGN KEY (who_liked_id) REFERENCES Users(id));


CREATE TABLE Comments(
id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
post_id INT NOT NULL,
author_id INT NOT NULL,
text VARCHAR(255),
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
FOREIGN KEY (post_id) REFERENCES Posts(id),
FOREIGN KEY (author_id) REFERENCES Users(id));
